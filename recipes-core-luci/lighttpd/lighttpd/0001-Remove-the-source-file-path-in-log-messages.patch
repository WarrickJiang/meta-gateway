From 89b9178f3a96c076b707a027f665917611821902 Mon Sep 17 00:00:00 2001
From: Haiqing Bai <Haiqing.Bai@windriver.com>
Date: Wed, 6 Apr 2016 14:56:15 +0800
Subject: [PATCH] Remove the source file path in log messages.

It is not right to show full path of source code in
log messages, this fix only keep the filename in log.

Upstream-status: Pending

Signed-off-by: Haiqing Bai <Haiqing.Bai@windriver.com>
---
 src/log.c |    3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

--- a/src/log.c
+++ b/src/log.c
@@ -8,6 +8,7 @@
 #include <time.h>
 #include <string.h>
 #include <stdarg.h>
+#include <libgen.h>
 #include <unistd.h>
 
 #ifdef HAVE_SYSLOG_H
@@ -155,7 +156,7 @@ static int log_buffer_prepare(buffer *b,
 		break;
 	}
 
-	buffer_append_string(b, filename);
+	buffer_append_string(b, basename(filename));
 	buffer_append_string_len(b, CONST_STR_LEN("."));
 	buffer_append_int(b, line);
 	buffer_append_string_len(b, CONST_STR_LEN(") "));
